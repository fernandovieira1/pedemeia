

# Certifique-se de usar as colunas reais do dataset
fia3 <- fia3 %>%
  mutate(
    escolhido = ifelse(row_number() %% 2 == 0, 2, 1) # Alterna valores entre 1 e 2
  )

# Obter os valores únicos reais para o loop de 'escolhido'
opcoes_escolhido <- unique(fia3$escolhido)

# Inicializar lista para armazenar tabelas
tabelas <- list()

# Loop para gerar tabelas com base na variável 'escolhido'
for (escolhido_atual in opcoes_escolhido) {
  # Filtrar dados com base no valor atual de 'escolhido'
  dados_filtrados <- fia3 %>%
    filter(escolhido == escolhido_atual) %>%
    group_by(venda) %>%
    summarize(
      Consumo_Sem_Descasque = sum(consumo_sem_descasque, na.rm = TRUE),
      Consumo_Com_Descasque = sum(consumo_COM_descasque, na.rm = TRUE)
    ) %>%
    mutate(
      Venda = recode(as.character(venda), "1" = "61 dias", "2" = "82 dias", "3" = "110 dias")
    ) %>%
    select(Venda, Consumo_Sem_Descasque, Consumo_Com_Descasque)
  
  # Criar tabela formatada
  tabela <- dados_filtrados %>%
    gt() %>%
    tab_header(
      title = paste("Consumo de MS por Período de Venda - Dataset:", ifelse(escolhido_atual == 1, "João Conte", "12 2023"))
    ) %>%
    cols_label(
      Venda = "Período de Venda",
      Consumo_Sem_Descasque = "Consumo Sem Descasque (kg)",
      Consumo_Com_Descasque = "Consumo Com Descasque (kg)"
    ) %>%
    fmt_number(
      columns = vars(Consumo_Sem_Descasque, Consumo_Com_Descasque),
      decimals = 2
    )
  
  # Adicionar tabela à lista
  tabelas[[paste("Escolhido", escolhido_atual)]] <- tabela
}

# Exibir tabelas no console ou exportar para HTML/PDF
for (nome_tabela in names(tabelas)) {
  print(nome_tabela)
  print(tabelas[[nome_tabela]])
}
